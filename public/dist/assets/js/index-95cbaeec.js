import{b as M,d as Q,x as S,r as C,$ as b,a0 as c,J as D,L as N,w as z,M as I,c as T,j as a,h as d,l as t,a as l,t as p,B as O,u as U,a1 as j,f,o as y,g as P,a2 as V,m as A,z as G,Q as J,n as Z}from"./index-ad449e55.js";import{L as W}from"./index-f87200d8.js";import{S as u}from"./index-061ae28c.js";const X={class:"login-container"},Y={class:"title-container"},ee={class:"title"},oe={class:"svg-container"},te={class:"svg-container"},se={class:"svg-container"},ae=["innerHTML"],ne={key:0,class:"copyright"},le=Q({setup(re){const{login:x}=S(),_=U(),w=C(b),v=C(c),o=D({redirect:"",loginForm:{username:"",password:"",captchaKey:"",code:""},loginRules:{username:[{required:!0,trigger:"blur"}],password:[{required:!0,trigger:"blur",validator:B}],code:[{required:!0,trigger:"blur"}]},loading:!1,passwordType:"password",captchaBase64:"",capslockTooltipDisabled:!0,otherQuery:{},clientHeight:document.documentElement.clientHeight,showCopyright:!0});function m(){j().then(e=>{o.loginForm.captchaKey=e.data.captchaKey,o.captchaBase64=e.data.content})}function B(e,s,n){s.length<6?n(new Error("The password can not be less than 6 digits")):n()}const{loginForm:r,loginRules:$,loading:K,passwordType:g,capslockTooltipDisabled:k,showCopyright:R}=N(o);function F(e){const{key:s}=e;o.capslockTooltipDisabled=s&&s.length===1&&s>="A"&&s<="Z"}function E(){o.passwordType==="password"?o.passwordType="":o.passwordType="password",J(()=>{v.value.focus()})}function h(){w.value.validate(e=>{if(e)o.loading=!0,x.login(o.loginForm).then(()=>{Z.push({path:o.redirect||"/",query:o.otherQuery}),o.loading=!1}).catch(()=>{o.loading=!1,m()});else return!1})}z(_,()=>{const e=_.query;e&&(o.redirect=e.redirect,o.otherQuery=H(e))},{immediate:!0});function H(e){return Object.keys(e).reduce((s,n)=>(n!=="redirect"&&(s[n]=e[n]),s),{})}return I(()=>{m(),window.onresize=()=>{o.clientHeight>document.documentElement.clientHeight?o.showCopyright=!1:o.showCopyright=!0}}),(e,s)=>{const n=f("el-form-item"),L=f("el-tooltip"),q=f("el-button");return y(),T("div",X,[a(t(b),{ref_key:"loginFormRef",ref:w,model:t(r),rules:t($),class:"login-form","auto-complete":"on","label-position":"left"},{default:d(()=>[l("div",Y,[l("h3",ee,p(e.$t("login.title")),1),a(W,{class:"set-language"})]),a(n,{prop:"username"},{default:d(()=>[l("span",oe,[a(u,{"icon-class":"user"})]),a(t(c),{ref:"username",modelValue:t(r).username,"onUpdate:modelValue":s[0]||(s[0]=i=>t(r).username=i),placeholder:e.$t("login.username"),name:"username",type:"text",tabindex:"1","auto-complete":"on"},null,8,["modelValue","placeholder"])]),_:1}),a(L,{disabled:t(k),content:"Caps lock is On",placement:"right"},{default:d(()=>[a(n,{prop:"password"},{default:d(()=>[l("span",te,[a(u,{"icon-class":"password"})]),(y(),P(t(c),{ref_key:"passwordRef",ref:v,key:t(g),modelValue:t(r).password,"onUpdate:modelValue":s[1]||(s[1]=i=>t(r).password=i),type:t(g),placeholder:e.$t("login.password"),name:"password",tabindex:"2","auto-complete":"on",onKeyup:[F,V(h,["enter"])],onBlur:s[2]||(s[2]=i=>k.value=!0)},null,8,["modelValue","type","placeholder","onKeyup"])),l("span",{class:"show-pwd",onClick:E},[a(u,{"icon-class":t(g)==="password"?"eye":"eye-open"},null,8,["icon-class"])])]),_:1})]),_:1},8,["disabled"]),a(n,{prop:"code"},{default:d(()=>[l("span",se,[a(u,{"icon-class":"validCode"})]),a(t(c),{modelValue:t(r).code,"onUpdate:modelValue":s[3]||(s[3]=i=>t(r).code=i),"auto-complete":"off",placeholder:e.$t("login.code"),style:{width:"65%"},onKeyup:V(h,["enter"])},null,8,["modelValue","placeholder","onKeyup"]),l("div",{class:"captcha",onClick:m},[l("div",{innerHTML:t(o).captchaBase64},null,8,ae)])]),_:1}),a(q,{size:"default",loading:t(K),type:"primary",style:{width:"100%","margin-bottom":"30px"},onClick:A(h,["prevent"])},{default:d(()=>[G(p(e.$t("login.login")),1)]),_:1},8,["loading","onClick"])]),_:1},8,["model","rules"]),t(R)==!0?(y(),T("div",ne,[l("p",null,p(e.$t("login.copyright")),1),l("p",null,p(e.$t("login.icp")),1)])):O("",!0)])}}});var pe=M(le,[["__scopeId","data-v-4f47a114"]]);export{pe as default};
